<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../static/style/pagina_cadastro/pagina-de-cadastro.css">
    <link rel="stylesheet" href="../static/style/reset.css">
    <link rel="stylesheet" href="../static/style/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link rel="shortcut icon" href="../static/img/Logo_minimizada.svg">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const passwordField = document.getElementById('password');
            const confirmPasswordField = document.getElementById('confirm_password');
            const emailField = document.getElementById('email');
            const usernameField = document.getElementById('username');

            function validatePassword() {
                const password = passwordField.value;
                const confirmPassword = confirmPasswordField.value;

                const valid = password.length >= 6 &&
                    /[a-z]/.test(password) &&
                    /[A-Z]/.test(password) &&
                    /\d/.test(password);

                passwordField.setCustomValidity(valid ? '' : 'A senha deve conter pelo menos 6 caracteres, incluindo uma letra maiúscula, uma letra minúscula e um número.');
                confirmPasswordField.setCustomValidity(password === confirmPassword ? '' : 'As senhas não coincidem.');
            }

            function validateEmail() {
                const email = emailField.value;
                const valid = /^\d{9}@estudante\.unb\.br$/.test(email);
                emailField.setCustomValidity(valid ? '' : 'Por favor, insira um email válido da UnB (exemplo: 123456789@estudante.unb.br).');
            }

            function toggleHelpMessage(field, message) {
                const helpMessage = document.createElement('small');
                helpMessage.textContent = message;
                helpMessage.style.display = 'none';
                helpMessage.className = 'help-message';
                helpMessage.style.marginTop = '5px';
                helpMessage.style.fontSize = '0.9em';
                helpMessage.style.color = '#555';

                field.parentElement.insertBefore(helpMessage, field.nextSibling);

                field.addEventListener('focus', () => {
                    helpMessage.style.display = 'block';
                });

                field.addEventListener('blur', () => {
                    helpMessage.style.display = 'none';
                });
            }

            toggleHelpMessage(usernameField, 'Escolha um nome de usuário exclusivo.');
            toggleHelpMessage(emailField, 'Digite seu email da UnB (exemplo: 123456789@estudante.unb.br).');
            toggleHelpMessage(passwordField, 'A senha deve conter pelo menos 6 caracteres, incluindo uma letra maiúscula, uma letra minúscula e um número.');

            emailField.addEventListener('input', validateEmail);
            passwordField.addEventListener('input', validatePassword);
            confirmPasswordField.addEventListener('input', validatePassword);

            document.querySelector('form').addEventListener('submit', (event) => {
                validatePassword();
                validateEmail();

                if (!emailField.checkValidity() || !passwordField.checkValidity() || !confirmPasswordField.checkValidity()) {
                    event.preventDefault();
                }
            });
        });
    </script>
</head>
<body>
    <form action="/cadastro" method="POST">
        <h1>Cadastro</h1>

        <label for="username">Nome de Usuário:</label>
        <input type="text" id="username" name="username" required>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <label for="password">Senha:</label>
        <input type="password" id="password" name="password" required>

        <label for="confirm_password">Repetir Senha:</label>
        <input type="password" id="confirm_password" name="confirm_password" required>

        <button type="submit">Cadastrar</button>

        <p>Já possui uma conta? <a href="login" class="btn">Entrar</a></p>
    </form>
</body>
</html>
