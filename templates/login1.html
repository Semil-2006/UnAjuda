<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/pagina-de-login.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const emailInput = document.getElementById("email");
            const passwordInput = document.getElementById("password");
            const submitButton = document.querySelector("button[type='submit']");
            const form = document.querySelector("form");

            const validateField = (input, feedbackMessage, condition) => {
                const feedback = input.nextElementSibling;
                if (condition) {
                    feedback.textContent = feedbackMessage;
                    input.style.borderColor = "red";
                } else {
                    feedback.textContent = "";
                    input.style.borderColor = "";
                }
            };

            const updateButtonState = () => {
                const emailValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value);
                const passwordValid = !!passwordInput.value;

                if (emailValid && passwordValid) {
                    submitButton.disabled = false;
                    submitButton.style.backgroundColor = "#8216ca";
                    submitButton.style.cursor = "pointer";
                } else {
                    submitButton.disabled = true;
                    submitButton.style.backgroundColor = "#ccc";
                    submitButton.style.cursor = "not-allowed";
                }
            };

            emailInput.addEventListener("input", () => {
                validateField(
                    emailInput,
                    "Por favor, insira um email válido.",
                    !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value)
                );
                updateButtonState();
            });

            emailInput.addEventListener("blur", () => {
                validateField(
                    emailInput,
                    "Este campo é obrigatório.",
                    !emailInput.value
                );
                updateButtonState();
            });

            passwordInput.addEventListener("input", () => {
                validateField(
                    passwordInput,
                    "Este campo é obrigatório.",
                    !passwordInput.value
                );
                updateButtonState();
            });

            passwordInput.addEventListener("blur", () => {
                validateField(
                    passwordInput,
                    "Este campo é obrigatório.",
                    !passwordInput.value
                );
                updateButtonState();
            });

            form.addEventListener("submit", (e) => {
                const emailCondition = !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value);

                validateField(
                    emailInput,
                    "Por favor, insira um email válido.",
                    emailCondition
                );

                validateField(
                    passwordInput,
                    "Este campo é obrigatório.",
                    !passwordInput.value
                );

                if (emailCondition || !passwordInput.value) {
                    e.preventDefault();
                    alert("Por favor, corrija os erros antes de enviar o formulário.");
                }
            });

            updateButtonState(); // Initial state update
        });
    </script>
</head>
<body>
    <form action="/login" method="POST">
        <h1>Login</h1>

        <label for="email">Email:</label>
        <br>
        <input type="email" id="email" name="email" required>
        <span class="feedback" style="color: red; font-size: 0.9em;"></span>
        <br><br>

        <label for="password">Senha:</label>
        <br>
        <input type="password" id="password" name="password" required>
        <span class="feedback" style="color: red; font-size: 0.9em;"></span>
        <br><br>

        <button type="submit" disabled style="background-color: #ccc; cursor: not-allowed;">Entrar</button>

        <p>Ainda não possui uma conta? <a href="cadastro" class="btn">Cadastre-se</a></p>
        <p>Esqueceu sua senha? <a href=" " class="btn">Recuperar senha</a></p>
    </form>
</body>
</html>
